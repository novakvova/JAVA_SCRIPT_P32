<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>АТБ - магазин</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
</head>

<body>
    <h1 class="text-center">Користувачів</h1>

    <div class="container">
        <a href="/" class="btn btn-link">На головну</a>

        <div class="row">
            <div class="col-9 mx-auto">

                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Фото</th>
                            <th scope="col">ПІБ</th>
                            <th scope="col">Телефон</th>
                            <th scope="col">Пошта</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                    </tbody>
                </table>

            </div>
        </div>

    </div>

    <script src="/js/bootstrap.bundle.min.js"></script>

    <script>
        const xhr = new XMLHttpRequest();
        // Створення нового XMLHttpRequest об'єкта
        // Запит виконується асинхронно - true
        xhr.open("GET", "https://lohika.itstep.click/api/Users/all", true);

        //Підписали на подію
        //Обробляємо коли задача була виконана
        xhr.onload = function () {
            // Тут можна відслідковувати процес проходження запиту
            if (xhr.status === 200) { // Якщо статус 200 - все ок
                //Це рядок тексту
                //console.log("Users json", xhr.response); // Виводимо відповідь сервера
                const users = JSON.parse(xhr.response); // Парсимо JSON рядок в об'єкт
                //console.log("Object users", users); // Виводимо масив об'єктів користувачів
                viewListUsers(users); // Викликаємо функцію для відображення користувачів
            }
        };
        xhr.send(); // Відправляємо запит на сервер

        const viewListUsers = (listUsers) => {
            const usersTableBody = document.getElementById("usersTableBody");
            usersTableBody.innerHTML = ""; // Очищаємо таблицю
            //index - це порядковий номер елемента в масиві
            listUsers.forEach((user, index) => {
                //Проходимося по кожному користувачу
                const tr = document.createElement("tr"); // Створюємо рядок таблиці
                tr.innerHTML = `
                        <tr>
                            <th scope="row">
                                ${index + 1}
                            </th>
                            <td>
                                <img 
                                    src="https://lohika.itstep.click/images/100_${user.photo}" 
                                    alt="Козак"
                                    width="75">
                            </td>
                            <td>${user.secondName} ${user.firstName}</td>
                            <td>${user.phone}</td>
                            <td>${user.email}</td>
                        </tr>
                    `; // Заповнюємо рядок даними користувача
                usersTableBody.appendChild(tr); // Додаємо рядок в таблицю
            });


        }

    </script>



    <script>
        const student = {
            name: "Іван",
            age: 21,
            isMarried: false,
            scores: [90, 85, 88],
            address: {
                city: "Київ",
                street: "Хрещатик",
                houseNumber: 10
            }
        };
        console.log("Об'єкт student:", student);

        // Перетворення об'єкта в JSON-рядок
        const studentJSON = JSON.stringify(student);
        console.log("JSON-рядок studentJSON:", studentJSON);

        // Перетворення JSON-рядка назад в об'єкт
        const parsedStudent = JSON.parse(studentJSON);
        console.log("Розпарсений об'єкт parsedStudent:", parsedStudent);

    </script>
</body>

</html>